<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Input Usulan Musrenbang</title>
<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:20px;border-radius:8px}
label{font-weight:bold}
input,select,textarea{width:100%;padding:8px;margin:5px 0 15px}
button{background:#28a745;color:#fff;border:none;padding:12px;width:100%;font-size:16px}
table{width:100%;border-collapse:collapse;margin-top:20px}
th{background:#34495e;color:#fff;padding:10px}
td{border:1px solid #ddd;padding:8px}
.aksi button{margin:2px;padding:5px 8px}
</style>
</head>

<body>
<div class="container">
<h3>Form Input Usulan</h3>

<form id="form">
<label>Bidang</label>
<select id="bidang" required>
<option value="">-- Pilih --</option>
<option value="SARPRAS">Bidang Sarana Prasarana</option>
<option value="SOSBUD">Bidang Sosial Budaya</option>
<option value="EKONOMI">Bidang Ekonomi</option>
</select>

<label>Kegiatan</label>
<input id="kegiatan" required>

<label>Lokasi</label>
<input id="lokasi">

<label>Volume</label>
<input id="volume">

<label>Anggaran (Rp)</label>
<input type="number" id="anggaran" required>

<label>OPD Tujuan</label>
<select id="opd" required>
<option value="">-- Pilih OPD --</option>
<option>DPUTR</option>
<option>DPRKP</option>
<option>DPKPP</option>
</select>

<label>Keterangan</label>
<textarea id="keterangan"></textarea>

<button type="submit">Kirim Usulan</button>
</form>

<h4>Daftar Usulan</h4>
<table>
<thead>
<tr>
<th>Kegiatan</th><th>Bidang</th><th>Lokasi</th><th>Volume</th>
<th>Anggaran</th><th>OPD</th><th>Keterangan</th><th>Aksi</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table>

<p style="text-align:right;font-weight:bold">
TOTAL ANGGARAN : Rp <span id="total">0</span>
</p>
</div>

<script>
const STORAGE_KEY="MUSRENBANG_USULAN";
let data=JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
let edit=null;

const mapBidang={
SARPRAS:"Sarana Prasarana",
SOSBUD:"Sosial Budaya",
EKONOMI:"Ekonomi"
};

form.onsubmit=e=>{
e.preventDefault();
if(!bidang.value||!kegiatan.value||!opd.value||!anggaran.value){
alert("Data wajib belum lengkap");return;
}
const item={
bidang:bidang.value,
kegiatan:kegiatan.value,
lokasi:lokasi.value,
volume:volume.value,
anggaran:Number(anggaran.value),
opd:opd.value,
keterangan:keterangan.value,
kelurahan:"Makale",
waktu:new Date().toLocaleString("id-ID")
};
edit===null?data.push(item):data[edit]=item;
localStorage.setItem(STORAGE_KEY,JSON.stringify(data));
form.reset();edit=null;render();
};

function render(){
tabel.innerHTML="";let total=0;
data.forEach((d,i)=>{
total+=d.anggaran;
tabel.innerHTML+=`
<tr>
<td>${d.kegiatan}</td>
<td>${mapBidang[d.bidang]}</td>
<td>${d.lokasi}</td>
<td>${d.volume}</td>
<td>${d.anggaran.toLocaleString("id-ID")}</td>
<td>${d.opd}</td>
<td>${d.keterangan}</td>
<td>
<button onclick="editData(${i})">✏️</button>
<button onclick="hapus(${i})">❌</button>
</td>
</tr>`;
});
totalEl=total;
totalSpan.textContent=total.toLocaleString("id-ID");
}
function hapus(i){if(confirm("Hapus?")){data.splice(i,1);render();save();}}
function editData(i){const d=data[i];edit=i;
bidang.value=d.bidang;kegiatan.value=d.kegiatan;lokasi.value=d.lokasi;
volume.value=d.volume;anggaran.value=d.anggaran;opd.value=d.opd;
keterangan.value=d.keterangan;}
function save(){localStorage.setItem(STORAGE_KEY,JSON.stringify(data));}
render();
</script>
</body>
</html>
